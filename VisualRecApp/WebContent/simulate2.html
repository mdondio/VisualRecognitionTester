<!DOCTYPE html>
<html>

<head></head>

<!-- Main inclusions -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
<!-- Functions -->
<script src="js/genericFunctions.js"></script>
<script src="js/functions.js"></script>
<!-- Carbon design scripts -->
<script src="js/index.js"></script>
<script src="js/bluemix-components.min.js"></script>
<script src="js/svgxuse.min.js"></script>
<!-- Utilities -->
<script src="js/jquery.lazy.min.js"></script>
<script src="js/tingle.min.js"></script>
<script src="js/FileSaver.min.js"></script>
<link rel="stylesheet" href="css/tingle.min.css">

<script>
createHead();
createCarbonHeader();
</script>

<body>
		
<div id="carbon-header"></div>
				
<br><br><br>
  
<div class="content" id="simulate">

	<div class="row clearfix">

		<div class="column fourth"><h1>Simulate</h1>
		</div>
	</div>
	
	<div class="row clearfix">

		<div class="column third"><h1>&ensp;</h1><strong class="bx--label">Add tests</strong><br>
			You can run 10 test at the same time
		</div>
		
		<div class="column third"><h1>&ensp;</h1><strong class="bx--label">Upload a new set</strong><br>
			Select positive and negative images to test Watson
		</div>
		
		<div class="column third"><h1>&ensp;</h1><strong class="bx--label">Run simulation</strong><br>
			When you are ready start the simulation with Watson
		</div>

	</div>

 	<br>
 
    <div class="row clearfix">
    	<div class="column full">
    	
				<form id="myForm" action="javascript:startSimulation();">
					<br>
					<hr class="lineseparator">
					
					<div style="text-align:center;">
						<button id="addicon" class="bx--btn bx--btn--secondary" type="button">
						  Add test
						  <svg class="bx--btn__icon">
						    <use xlink:href="/carbon-icons/bluemix-icons.svg#icon--add--glyph"></use>
						  </svg>
						</button>
						<button id="uploadicon" class="bx--btn bx--btn--secondary" type="button">Upload set</button>
						<button id="playicon" class="bx--btn bx--btn--primary" type="submit">Run simulation</button>
					</div>
					
					<hr class="lineseparator">
					<br>

					<div class="row clearfix moltiplicandum" id="moltiplicandum1" style="margin-bottom: 20px; margin-left: 200px;">

						<div class="column fourth">						
								<div class="bx--form-item">
								  <input id="testname1" type="text" class="bx--text-input" placeholder="TEST_1" required>
								</div>	
						</div>						
						
						<div class="column fourth">
								<div class="bx--form-item">
								  <div class="bx--select">
								    <select id="testset1" class="bx--select-input" required>
								      <option class="bx--select-option" disabled selected hidden value="">Select test set</option>
								    </select>
								    <svg class="bx--select__arrow">
								      <use xlink:href="/carbon-icons/bluemix-icons.svg#icon--caret--down"></use>
								    </svg>
								  </div>
								</div>
						</div>
							
						<div class="column fourth">			
								<div class="bx--form-item">
								  <div class="bx--select">
								    <select id="testclassifier1" class="bx--select-input" required>
								      <option class="bx--select-option" disabled selected hidden value="">Select classifier</option>
								    </select>
								    <svg class="bx--select__arrow">
								      <use xlink:href="/carbon-icons/bluemix-icons.svg#icon--caret--down"></use>
								    </svg>
								  </div>
								</div>
						</div>
						
						<div class="column fourth">
								<img id="reload1" data-alt-src="ico/reload.png" src="ico/reloadDARK.png" style="width:40px;height:auto;margin-left:15px;margin-right:15px;">
								<img id="garbage1" data-alt-src="ico/garbage.png" src="ico/garbageDARK.png" style="width:40px;height:auto;margin-left:15px;margin-right:15px;">
						</div>
						
					</div>
				</form>
				
      </div>
    </div>
    
  </div>
  
<!--   ================================================================ -->
<!--   ====================== WAITING LOGO ============================ -->
<!--   ================================================================ -->
  
  <!-- Icona Watson -->
<!--    	<div class="content" id="waiting" style="display:none;"> -->
<!-- 		<img src='ico/load.svg' id="logowait waiting" style="display: none"> -->
		<img src='ico/load.svg' id="waiting" style="display: none;">
<!-- 	</div> -->
		
<!--   ================================================================ -->
<!--   ====================== SHOW PAGE =============================== -->
<!--   ================================================================ -->

	<div class="content" id="showtest" style="display: none;">
	
	
		<div class="row clearfix">
			
			<div class="column third"><h1>Test results</h1><br><br>
			
			
			<div class="row clearfix">
				<div class="column full">
					<select id="show_test" class="bx--select-input"></select>
					<br><br>
					<div class="post-preview" style="text-align:center;">
					<button class="bx--btn bx--btn--primary" id="saveJSON" type="sumbit">Save to JSON file</button>
					<button class="bx--btn bx--btn--primary" id="saveJSONDB" type="sumbit">Save to DB</button>
					</div>
				</div>
			</div>
		<hr class="lineseparator">
			<div class="row clearfix">

				<div class="column half">
					<div class="post-preview" style="width: 100%; height: auto">
						<div class="circumference large" style="margin:auto;" id=accuracy>--.--</div>
						<p class="title center">accuracy</p>
					</div>
					<br>
					<div class="post-preview" style="width: 100%; height: auto">
						<div class="circumference large" style="margin:auto;" id=auctest>--.--</div>
						<p class="title center">AUC</p>
					</div>
				</div>

				<div class="column half">
					<div class="post-preview" style="width: 100%; height: auto">
						<div class="circumference large" style="margin:auto;" id=threshold>--.--</div>
						<p class="title center">threshold</p>
					</div>
					<br>
					<div class="post-preview" style="width: 100%; height: auto">
						<div class="circumference large" style="margin:auto;" id=indice>--.--</div>
						<p class="title center">F-positive</p>
					</div>
				</div>

			</div>
				
		</div>
			
				<div class="column two-thirds">
				
	
					<nav data-tabs class="bx--tabs" role="navigation">
					
						  <div class="bx--tabs-trigger" tabindex="0">
						    <a href="javascript:void(0)" class="bx--tabs-trigger-text" tabindex="-1"></a>
<!-- 						    <svg width="10" height="5" viewBox="0 0 10 5" fill-rule="evenodd"> -->
<!-- 						      <path d="M10 0L5 5 0 0z"></path> -->
<!-- 						    </svg> -->
						  </div>
						  
						  <ul class="bx--tabs__nav bx--tabs__nav--hidden" role="tablist">
						    <li class="bx--tabs__nav-item bx--tabs__nav-item--selected" data-target=".tab-1" role="presentation">
						      <a id="tab-link-1" class="bx--tabs__nav-link" href="javascript:void(0)" role="tab" aria-controls="tab-panel-1" aria-selected="true">ROC analysis</a>
						    </li>
						    <li class="bx--tabs__nav-item" data-target=".tab-2" role="presentation">
						      <a id="tab-link-2" class="bx--tabs__nav-link" href="javascript:void(0)" role="tab" aria-controls="tab-panel-2" aria-selected="false">Distribution</a>
						    </li>
						    <li class="bx--tabs__nav-item" data-target=".tab-3" role="presentation">
						      <a id="tab-link-3" class="bx--tabs__nav-link" href="javascript:void(0)" role="tab" aria-controls="tab-panel-3" aria-selected="false">Results recap</a>
						    </li>
						    <li class="bx--tabs__nav-item" data-target=".tab-4" role="presentation">
						      <a id="tab-link-4" class="bx--tabs__nav-link" href="javascript:void(0)" role="tab" aria-controls="tab-panel-4" aria-selected="false">False positive</a>
						    </li>
						    <li class="bx--tabs__nav-item" data-target=".tab-5" role="presentation">
						      <a id="tab-link-5" class="bx--tabs__nav-link" href="javascript:void(0)" role="tab" aria-controls="tab-panel-5" aria-selected="false">False negative</a>
						    </li>
						  </ul>
						  
					</nav>
					
					<div style="padding: 1rem;"> 
					  <div id="tab-panel-1" class="tab-1" role="tabpanel" aria-labelledby="tab-link-1" aria-hidden="false">
					    <div class="post-preview" id="graph1"></div>
					  </div>
					  <div id="tab-panel-2" class="tab-2" role="tabpanel" aria-labelledby="tab-link-2" aria-hidden="true" hidden>
					  	<div class="post-preview" id="graph_histogram"></div>
					  </div>
					  <div id="tab-panel-3" class="tab-3" role="tabpanel" aria-labelledby="tab-link-3" aria-hidden="true" hidden>
					    <div class="post-preview" id="graph2"></div>
					  </div>
					  <div id="tab-panel-4" class="tab-4" role="tabpanel" aria-labelledby="tab-link-4" aria-hidden="true" hidden>
						<div class="post-preview" id="galleryFP"></div>
					  </div>
					  <div id="tab-panel-5" class="tab-5" role="tabpanel" aria-labelledby="tab-link-5" aria-hidden="true" hidden>
						<div class="post-preview" id="galleryFN"></div>
					  </div>
					</div>
				
				
				
				</div>
		
		</div>
	
	
<!-- 	==================================================================== -->
<!-- 	===================== PRIMA COLONNA ================================ -->
<!-- 	==================================================================== -->
<!-- 		<div class="column third"> -->

<!-- 			<div class="row clearfix"> -->
<!-- 				<div class="column full"> -->
<!-- 					<select id="show_test"></select> -->
<!-- 					<br><br> -->
<!-- 					<div class="post-preview" style="text-align:center;"> -->
<!-- 					<button class="rectangle" id="saveJSON">Save to JSON file</button> -->
<!-- 					<button class="rectangle" id="saveJSONDB">Save to DB</button> -->
<!-- 					</div> -->
<!-- 				</div> -->
<!-- 			</div> -->
<!-- 		<hr class="lineseparator"> -->
<!-- 			<div class="row clearfix"> -->

<!-- 				<div class="column half"> -->
<!-- 					<div class="post-preview" style="width: 100%; height: auto"> -->
<!-- 						<div class="circumference large" style="margin:auto;" id=accuracy>--.--</div> -->
<!-- 						<p class="title center">accuracy</p> -->
<!-- 					</div> -->
<!-- 					<br> -->
<!-- 					<div class="post-preview" style="width: 100%; height: auto"> -->
<!-- 						<div class="circumference large" style="margin:auto;" id=auctest>--.--</div> -->
<!-- 						<p class="title center">AUC</p> -->
<!-- 					</div> -->
<!-- 				</div> -->

<!-- 				<div class="column half"> -->
<!-- 					<div class="post-preview" style="width: 100%; height: auto"> -->
<!-- 						<div class="circumference large" style="margin:auto;" id=threshold>--.--</div> -->
<!-- 						<p class="title center">threshold</p> -->
<!-- 					</div> -->
<!-- 					<br> -->
<!-- 					<div class="post-preview" style="width: 100%; height: auto"> -->
<!-- 						<div class="circumference large" style="margin:auto;" id=indice>--.--</div> -->
<!-- 						<p class="title center">F-positive</p> -->
<!-- 					</div> -->
<!-- 				</div> -->

<!-- 			</div> -->

<!-- 			<br> <br> -->

<!-- 			<hr class="lineseparator"> -->

<!-- 			<div class="row clearfix"> -->
<!-- 				<div class="column full"> -->
<!-- 					<p class='title left'> -->
<!-- 						false positives -->
<!-- 					</p> -->
<!-- 					<p class='paragraph left'>is a result that indicates a given condition -->
<!-- 						has been fulfilled, when it has not</p> -->
<!-- 				<br> -->
<!-- 					<div class="post-preview" id="galleryFP"></div> -->
<!-- 				</div> -->
<!-- 			</div> -->

<!-- 			<hr class="lineseparator"> -->

<!-- 			<div class="row clearfix"> -->
<!-- 				<div class="column full"> -->
<!-- 					<p class='title left'> -->
<!-- 						false negatives -->
<!-- 					</p> -->
<!-- 					<p class='paragraph left'>is where a test result indicates that a -->
<!-- 						condition failed, while it was successful</p> -->
<!-- 				<br> -->
<!-- 					<div class="post-preview" id="galleryFN"></div> -->
<!-- 				</div> -->
<!-- 			</div> -->

<!-- 			<hr class="lineseparator"> -->

<!-- 		</div> -->

<!-- 		==================================================================== -->
<!-- 		===================== SECONDA COLONNA ================================ -->
<!-- 		==================================================================== -->
<!-- 		<div class="column third"> -->

<!-- 			<div class="column full"> -->
<!-- 					===========================		GRAFICO ROC CURVE ============================= -->
<!-- 				<div class="row clearfix"> -->
<!-- 						<div class="post-preview"> -->
<!-- 							<div> -->
<!-- 								<p class="title left">ROC curve</p> -->
<!-- 								<p class="paragraph left">In -->
<!-- 									statistics, a receiver operating characteristic curve, or ROC -->
<!-- 									curve, is a graphical plot that illustrates the performance of -->
<!-- 									a binary classifier system as its discrimination threshold is -->
<!-- 									varied.</p> -->
<!-- 							</div> -->
<!-- 						</div> -->
<!-- 				</div> -->
<!-- 				<br> -->
<!-- 				<div class="row clearfix"> -->
<!-- 					<div class="post-preview" id="graph1"></div> -->
<!-- 				</div> -->
<!-- 					============================= FINE ROC CURVE ============================= -->
<!-- 				<hr class="lineseparator"> -->
<!-- 									===========================		GRAFICO AUC CURVE ============================= -->
<!-- 				<div class="row clearfix"> -->
<!-- 					<div class="post-preview"> -->
<!-- 						<div> -->
<!-- 							<p class="title left">AUC curve</p> -->
<!-- 							<p class="paragraph left">The -->
<!-- 								area under the curve (often referred to as simply the AUC) is -->
<!-- 								equal to the probability that a classifier will rank a randomly -->
<!-- 								chosen positive instance higher than a randomly chosen negative -->
<!-- 								one</p> -->
<!-- 						</div> -->
<!-- 					</div> -->
<!-- 				</div> -->
<!-- 				<br> -->

<!-- 				<div class="row clearfix"> -->
<!-- 					<div class="post-preview" id="graph2"></div> -->
<!-- 				</div> -->
<!-- <!-- 	============================= FINE AUC CURVE ============================= -->
<!-- 				<hr class="lineseparator"> -->

<!-- 			</div> -->

<!-- <br><br><br> -->

<!-- 		</div> -->
		
<!-- 		==================================================================== -->
<!-- 		===================== TERZA COLONNA ================================ -->
<!-- 		==================================================================== -->

<!-- 		<div class="column third"> -->

<!-- 			<div class="column full"> -->
<!-- <!-- 	============================= DISTRIBUTION CURVE ============================= -->
<!-- 				<div class="row clearfix"> -->
<!-- 					<div class="post-preview"> -->
<!-- 						<div> -->
<!-- 							<p class="title left">Distribution -->
<!-- 								curve</p> -->
<!-- 							<p class="paragraph left">Thanks to Visual Recognition scores, we can draw the negative and the positive distribution curves. Classifier effectiveness increases if VR instance is able to better separate the positive population from the negative one.</p> -->
<!-- 						</div> -->
<!-- 					</div> -->
<!-- 				</div> -->
<!-- 				<br> -->
<!-- 				<div class="row clearfix"> -->
<!-- 					<div class="post-preview" id="graph_histogram"></div> -->
<!-- 				</div> -->
<!-- 					============================= FINE DISTRIBUTION CURVE ============================= -->

<!-- 				<hr class="lineseparator"> -->
<!-- 			</div> -->



<!-- 		</div> -->


<!-- 	</div> -->

	<!-- gestione della preview immagini -->

<!-- 	<div id="myModalFP" class="modal"> -->
<!-- 		<span class="close cursor" onclick="closeModal()">&#10005;</span> -->
<!-- 		<div class="modal-content" id="modalcontentFP"></div> -->
<!-- 	</div> -->

<!-- 	<div id="myModalFN" class="modal"> -->
<!-- 		<span class="close cursor" onclick="closeModal()">&#10005;</span> -->
<!-- 		<div class="modal-content" id="modalcontentFN"></div> -->
<!-- 	</div> -->
	
<!-- 	SI POTREBBE GENERALIZZARE CREANDO L'INTERFACCIA MODAL PER POPUP WINDOWS -->

<!-- 		<div id="myModalTest" class="modalTest"> -->

<!-- 	<div id="savetestmodal" style="display:none;"> -->
<!-- 		<div class="modal2" id="savetestmodalbackground"></div> -->
<!-- 		<div class="modal-content2" id="savetestmodalcontent">	 -->
<!-- 		<span class="titlemodal">Select which test result save on your PC</span> -->
<!-- 		<span class="cursormodal" onclick="closeModal2()">&#10005;</span>  -->
<!-- 		<form id="listatest" action="javascript:printTestResults();" class="formmodal"> -->
<!-- 		</form> -->
<!-- 	</div>  -->
		

	</div>


</body>





<script>

$( document ).ready(function() {

if(localStorage.getItem("viewresult")=="history")
{
localStorage.setItem("viewresult", "simulation");
//mostro subito la parte di show
$("#simulate").hide();
$("#showtest").show("slow");
buildSelectTestResult('#show_test');
updateTestFields('#show_test');
}
});


//ADD button actions
$('#addicon').mouseover(function(){
	$(this).attr('src','ico/addicon.png');
});

$('#addicon').mouseleave(function(){
	$(this).attr('src',"ico/addDARK.png" );
});

var TOTALROWSFILLED = 1;
$('#addicon').click(function(){
if(TOTALROWSFILLED < 10){
      var $div = $('div[id^="moltiplicandum"]:last'); // seleziono l'ultimo moltiplicandum
      var nextrow = parseInt( $div.prop("id").match(/\d+/g), 10 ) +1; // estraggo il numero identificativo e lo incremento
      var currentrow = nextrow-1;       
      $("#moltiplicandum"+currentrow).clone().prop('id', 'moltiplicandum'+nextrow).appendTo("#myForm"); // clono, rinomino e appendo
      $("#moltiplicandum"+nextrow).find('input:text').val("TEST_"+nextrow);
      $("#moltiplicandum"+nextrow).find("input#testname"+currentrow).attr("id","testname"+nextrow);
      $("#moltiplicandum"+nextrow).find("select#testset"+currentrow).attr("id","testset"+nextrow);
      $("#moltiplicandum"+nextrow).find("select#testclassifier"+currentrow).attr("id","testclassifier"+nextrow);
      $("#moltiplicandum"+nextrow).find("img#reload"+currentrow).attr("id","reload"+nextrow);
      $("#moltiplicandum"+nextrow).find("img#garbage"+currentrow).attr("id","garbage"+nextrow);
    } else {
    swal({
				title: "Warning",
				text: "Max number of entries reached. You can run max 10 tests simultaneously.",
				type: "warning"});
    }
    TOTALROWSFILLED++;
});

//UPLOAD button actions
$('#uploadicon').mouseover(function(){
	$(this).attr('src','ico/upload.png');
});

$('#uploadicon').mouseleave(function(){
	$(this).attr('src',"ico/uploadDARK.png" );
});

$('#uploadicon').click(function(){
	//forcing page change without checking for correct test insertions
	document.location.href = 'upload.html';
});

//PLAY button actions
$('#playicon').mouseover(function(){
	$(this).attr('src','ico/play-button.png');
});

$('#playicon').mouseleave(function(){
	$(this).attr('src',"ico/play-buttonDARK.png" );
});

//RELOAD button actions
$('body').on("mouseover","img[id*=reload]",function(){
 	$(this).attr('src',"ico/reload.png");
});

$('body').on("mouseleave","img[id*=reload]",function(){
 	$(this).attr('src',"ico/reloadDARK.png");
});

$('body').on("click","img[id*=reload]",function(){
	var $this = $(this);
	var num = parseInt($this.prop("id").substring(6));
  	$("#moltiplicandum"+num).find('input:text').val("TEST_"+num);
 	$("#moltiplicandum"+num).find('select').val("").find('select').val("");      
});

//GARBAGE button actions
$('body').on("mouseover","img[id*=garbage]",function(){
 	$(this).attr('src',"ico/garbage.png");
});

$('body').on("mouseleave","img[id*=garbage]",function(){
 	$(this).attr('src',"ico/garbageDARK.png");
});

$('body').on("click","img[id*=garbage]",function(){
	var $this = $(this);
	var num = parseInt($this.prop("id").substring(7));
	var size = Array.prototype.map.call($(".moltiplicandum input"),(function(el){return el.value;}));
	if(size.length>1) 
	{
	$("#moltiplicandum"+num).remove();
		TOTALROWSFILLED--;
	}
	else swal({
				title: "Warning",
				text: "You have to run at least one test",
				type: "warning"});
});

// ON CHANGE select test
	$('#show_test').on(
			'change',
			function() {
			updateTestFields('#show_test');
});   

$('#saveJSON').click(function(){

	//openModal2();
	createMyModal();

});

$('#saveJSONDB').click(function(){
 			swal({
 			
				title: "Warning",
				text: "We are working hard on this feature... just relax and run a new simulation.",
				type: "warning"});
				
				});
				
</script>

<script>
buildSelectDataSet("test_set",'[id*="testset"]');
buildSelectClassifier("ready",'[id*="testclassifier"]');
</script>

</html>
